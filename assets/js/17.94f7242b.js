(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{209:function(t,s,a){t.exports=a.p+"assets/img/javascript-browser-EventLoop-taskQueue.b9e7e75d.jpg"},210:function(t,s,a){t.exports=a.p+"assets/img/javascript-browser-EventLoop.80f6e345.jpg"},211:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQUAAACDCAMAAACz1v7SAAAAAXNSR0IB2cksfwAAAvdQTFRF////AAAA+/v7lZWV29vbc3NzpaWltra2y8vLLy8vuLi4QEBAS0tL/v7+AQEB/f39+Pj4/Pz8+vr69vb2DAwM9/f3AgICAwMDysrK8fHxQkJCw8PDBgYG9fX1o6Oj8vLyBwcH+fn5wMDAGRkZBQUFERER1tbWGhoaJycnCgoKEBAQBAQEExMT4+Pj9PT08/PzIyMj6OjozMzMGxsb7+/vDw8PDQ0NCwsLnJyc6urq0tLSCQkJsbGx7Ozs8PDw7u7u3NzcZmZmUlJSampq4ODgjo6OWFhYf39/TU1Nvr6+T09PSEhIJCQkz8/PXl5eFBQU0NDQj4+PFxcXJSUl7e3tEhIS6enpbGxsFRUVCAgIYWFhwsLCDg4OjY2N6+vrRERE39/f4uLisrKybm5uGBgY5+fndXV1MjIyZ2dneXl52dnZZWVl3t7eoqKiIiIira2tvb29pKSk2trazs7OPz8/2NjYdHR0xMTEMzMzgoKC09PTUVFRpqamubm5u7u7MDAwfHx8n5+fcnJympqah4eH0dHRg4ODqqqqKSkpJiYmMTExmZmZgYGBi4uLYmJiVFRUUFBQ19fX4eHhq6urWVlZhoaGioqKv7+/p6enenp6tLS0V1dXRkZGlJSUxsbG5eXlmJiYPDw8SUlJkZGRPT09oKCgKCgob29vFhYWkJCQHBwcTExM5ubm5OTkKysrt7e3l5eX1dXVk5OTaWlpsLCwa2trs7OzZGRkTk5OLS0tR0dHoaGhNzc33d3dx8fHISEhdnZ2bW1tXFxcU1NTQUFBxcXFNDQ0NTU1iYmJr6+vOTk5Ojo6ICAgLi4uY2NjX19fNjY2Hh4ezc3NcXFxyMjIe3t7vLy8rKysWlpaqampm5ubHR0dfn5+Pj4+1NTUXV1daGhoycnJcHBwLCwsW1tbwcHBjIyMKioqVVVVRUVFtbW1nZ2dQ0NDfX19d3d3Ozs7np6eSkpKrq6ukpKSiIiIYGBgurq6gICAqKioVlZWeHh4hISEODg4Nlsg4AAAAP10Uk5T/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9tN244AABDHSURBVHic7ZxnXBNJH4DnH4oi7qaRjUgCiYSW0KvA0RQUVERAmhQVRRFQRAQBUQQEe++9995777333tvp9X4f3kmAM568yCK5iL99vkA288/OPpmdsjMThBiIBdrOAQMDAwMDAwMDAwMDAwMDw9cPYTzgWKPMWzML9RswhTNvZb4elGNG1FEC51H5+C5bejy+UlKi13ApKbnSY0uXLteucuskwVj/wZZ5Q/39BNy6avwiILgCP//rG7dMXGJWh2j7MRM3BvLqPVNagrV22dKf+bTDiDLDPXWR98XC2T+wmHah9m2aL9ZEZrQHq+UPPnRj4jvkaCIr2sTuj810QxKXNug6sTrsT06gW7wnjNNITrSJ1HRNd5ohRSEayYk24W7fPYlmyJ00jeREm7CHdu1EM8R2bX2cmGP3nmipq90Czgdv8+3sXNWqH25SgUmL7HUcpBmIGd9ephni1vnzTslLWuDERZZt3nMt483UdEv1Opft3KbNsvcdW/HMgN1785o/XUX37q0t8c0b04ww8v28M2b0WTw+GrUg33Px8jYqtsUHFr4hyRWsqlfd/4pUAIbquaOTZtqn+ObNaEYYGX/eGTt1hX6BqJm1tXU/I4CIUdbWEwYUPtQb8KEFgB5VFqS3zUmFY/DNFzbg0VozpcFESxYEGRkZM14B5OtmZCzgif1cWepp1C0Qx06QcL4sJWmfjhFYNfq8k/8f6tnC1OD0nLtnrJeGuyLl3R1w4sBoPR/EvToh+JdmBLdt8ISgPYaxYNM1OBu/r9sOQEd5ra4bdz4tIBCx74phhycvk/lVFiaN3znhuniVBNqrao3oFUDe7M7+JbhjKK4/pwUH44LBDj10+sCuGE/c9ckKDg7ByfoGT/geJ7Y8tOjSk9bZtbuD6tmCBUTdVIiEQI7jIUFLC1LkLQTDdSgpV0Hlem7wgFEmb+MoIOO8h6pb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"},212:function(t,s,a){t.exports=a.p+"assets/img/javascript-browser-EventLoop-node-eg2.494a2384.png"},351:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"event-loop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#event-loop"}},[t._v("#")]),t._v(" Event Loop")]),t._v(" "),n("p",[t._v("JS 执行是单线程的，这也意味着，javascript代码在执行的任何时候，都只有一个主线程来处理所有的任务。而这种机制基于事件循环来实现的。")]),t._v(" "),n("h2",{attrs:{id:"浏览器的-eventloop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的-eventloop"}},[t._v("#")]),t._v(" 浏览器的 EventLoop")]),t._v(" "),n("h3",{attrs:{id:"任务队列"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#任务队列"}},[t._v("#")]),t._v(" 任务队列")]),t._v(" "),n("p",[t._v("单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。如果前一个任务耗时很长，后一个任务就不得不一直等着。")]),t._v(" "),n("p",[t._v("单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。如果前一个任务耗时很长，后一个任务就不得不一直等着。")]),t._v(" "),n("p",[t._v("如果排队是因为计算量大，CPU 忙不过来，倒也算了，但是很多时候CPU是闲着的，因为 IO 设备（输入输出设备）很慢（比如 Ajax 操作从网络读取数据），不得不等着结果出来，再往下执行。")]),t._v(" "),n("p",[t._v("JavaScrip t语言的设计者意识到，这时主线程完全可以不管IO设备，挂起处于等待中的任务，先运行排在后面的任务。等到IO设备返回了结果，再回过头，把挂起的任务继续执行下去。")]),t._v(" "),n("p",[t._v('于是，所有任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）。同步任务指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；异步任务指的是，不进入主线程、而进入"任务队列"（task queue）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。')]),t._v(" "),n("p",[t._v("具体来说，异步执行的运行机制如下。（同步执行也是如此，因为它可以被视为没有异步任务的异步执行。）")]),t._v(" "),n("ol",[n("li",[t._v("所有同步任务都在主线程上执行，形成一个执行栈（execution context stack）")]),t._v(" "),n("li",[t._v('主线程之外，还存在一个"任务队列"（task queue）。只要异步任务有了运行结果，就在"任务队列"之中放置一个事件。')]),t._v(" "),n("li",[t._v('一旦"执行栈"中的所有同步任务执行完毕，系统就会读取"任务队列"，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。')]),t._v(" "),n("li",[t._v("主线程不断重复上面的第三步。")])]),t._v(" "),n("p",[t._v("下图就是主线程和任务队列的示意图：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(209),alt:"Task Queue"}})]),t._v(" "),n("h3",{attrs:{id:"事件和回调函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事件和回调函数"}},[t._v("#")]),t._v(" 事件和回调函数")]),t._v(" "),n("p",[t._v('"任务队列"是一个事件的队列（也可以理解成消息的队列），IO 设备完成一项任务，'),n("strong",[t._v('就在"任务队列"中添加一个事件，表示相关的异步任务可以进入"执行栈"了')]),t._v('。主线程读取"任务队列"，就是读取里面有哪些事件。')]),t._v(" "),n("p",[t._v('"任务队列"中的事件，除了 IO 设备的事件以外，还包括一些用户产生的事件（比如鼠标点击、页面滚动等等）。只要指定过回调函数，这些事件发生时就会进入"任务队列"，等待主线程读取。')]),t._v(" "),n("p",[t._v('所谓"回调函数"（callback），就是那些会被主线程挂起来的代码。异步任务必须指定回调函数，当主线程开始执行异步任务，就是执行对应的回调函数。')]),t._v(" "),n("p",[t._v('"任务队列"是一个先进先出的数据结构，排在前面的事件，优先被主线程读取。主线程的读取过程基本上是自动的，只要执行栈一清空，"任务队列"上第一位的事件就自动进入主线程。但是，由于存在"定时器"功能，可以放置定时事件，就是 '),n("code",[t._v("setTimeout")]),t._v(" 和 "),n("code",[t._v("setInterval")]),t._v("，主线程首先要检查一下执行时间，只有到了规定的时间，才能返回主线程。")]),t._v(" "),n("h3",{attrs:{id:"event-loop-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#event-loop-2"}},[t._v("#")]),t._v(" Event Loop")]),t._v(" "),n("p",[t._v('主线程从"任务队列"中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为Event Loop（事件循环）。')]),t._v(" "),n("p",[t._v("为了更好地理解Event Loop，请看下图（转引自Philip Roberts的演讲《Help, I'm stuck in an event-loop》）。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(210),alt:"EventLoop"}})]),t._v(" "),n("p",[t._v('上图中，主线程运行的时候，产生堆（heap）和栈（stack），栈中的代码调用各种外部API，它们在"任务队列"中加入各种事件（click，load，done）。只要栈中的代码执行完毕，主线程就会去读取"任务队列"，依次执行那些事件所对应的回调函数。')]),t._v(" "),n("p",[t._v("值得注意的是，任务队列的所有任务并不是怪怪排队的。")]),t._v(" "),n("h3",{attrs:{id:"宏任务与微任务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#宏任务与微任务"}},[t._v("#")]),t._v(" 宏任务与微任务")]),t._v(" "),n("p",[t._v("异步任务也存在优先级，把异步任务分为两类："),n("strong",[t._v("微任务")]),t._v("（micro task）和"),n("strong",[t._v("宏任务")]),t._v("（macro task）。常见的有：")]),t._v(" "),n("ul",[n("li",[t._v("Task(macroTask): setTimeout, setInterval, setImmediate, I/O, UI rendering。")]),t._v(" "),n("li",[t._v("microTask: Promise, process.nextTick, Object.observe, MutationObserver。")])]),t._v(" "),n("p",[t._v("针对这两种任务类型，任务队列实际上也对应有微任务队列和宏任务队列。当主线程执行栈为空时，主线程先查看微任务队列是否有事件存在：")]),t._v(" "),n("ol",[n("li",[t._v("如果有事件存在，"),n("strong",[t._v("会依次执行队列中事件对应的回调，直到微任务队列为空")]),t._v("。然后去宏任务队列中取出最前面的一个事件，把对应的回调加入当前执行栈。")]),t._v(" "),n("li",[t._v("如果事件不存在，则再去宏任务队列中取出一个事件并把对应的回到加入当前执行栈。")])]),t._v(" "),n("p",[t._v("需要记住"),n("strong",[t._v("当前执行栈执行完毕时会立刻先处理所有微任务队列中的事件，然后再去宏任务队列中取出一个事件。同一次事件循环中，微任务永远在宏任务之前执行")]),t._v("。")]),t._v(" "),n("h3",{attrs:{id:"看一道题目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#看一道题目"}},[t._v("#")]),t._v(" 看一道题目")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script start'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'setTimeout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nPromise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'promise1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'promise2'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script end'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("输出的顺序是：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("script start\nscript end\npromise1\npromise2\nsetTimeout\n")])])]),n("p",[t._v("因为 "),n("code",[t._v("Promise")]),t._v(" 是微任务，执行会优先于 "),n("code",[t._v("setTimeout")]),t._v("。")]),t._v(" "),n("h3",{attrs:{id:"结合前面的线程再看看"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#结合前面的线程再看看"}},[t._v("#")]),t._v(" 结合前面的线程再看看")]),t._v(" "),n("p",[t._v("在整个循环中，需要这些线程：")]),t._v(" "),n("ol",[n("li",[t._v("JS 引擎线程：主线程，执行任务。")]),t._v(" "),n("li",[t._v("事件触发线程：事件触发线程管理着一个任务队列，只要异步任务有了运行结果，就在任务队列之中放置一个事件。")]),t._v(" "),n("li",[t._v("定时触发器线程：定时计数器并不是由 JavaScript 引擎计数的，因为JavaScript引擎是单线程的, 如果处于阻塞线程状态就会影响记计时的准确。所以通过定时触发器线程来触发定时并计时，计时完毕后，添加到事件队列中，等待JS引擎空闲后执行。")])]),t._v(" "),n("h2",{attrs:{id:"node-环境的-eventloop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-环境的-eventloop"}},[t._v("#")]),t._v(" Node 环境的 EventLoop")]),t._v(" "),n("p",[t._v("在 node 中，事件循环表现出的状态与浏览器中大致相同。不同的是node中有一套自己的模型。node 中事件循环的实现是依靠的 libuv 引擎。我们知道 node 选择 chrome v8 引擎作为 js 解释器，v8 引擎将 js 代码分析后去调用对应的node api，而这些api最后则由 libuv 引擎驱动，执行对应的任务，并把不同的事件放在不同的队列中等待主线程执行。 因此实际上 node 中的事件循环存在于 libuv 引擎中。")]),t._v(" "),n("p",[t._v("为了协调异步任务，Node 居然提供了四个定时器，让任务可以在指定的时间运行。")]),t._v(" "),n("ul",[n("li",[t._v("setTimeout()")]),t._v(" "),n("li",[t._v("setInterval()")]),t._v(" "),n("li",[t._v("setImmediate()")]),t._v(" "),n("li",[t._v("process.nextTick()")])]),t._v(" "),n("p",[t._v("先看一段代码，它的运行结果是多少呢？")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// test.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setImmediate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nprocess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nPromise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("运行结果如下：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("node test.js\n5\n3\n4\n1\n2\n")])])]),n("p",[t._v("为什么是这样，接下来看看 Node 怎么处理各种定时器，或者更广义地说，libuv 库怎么安排异步任务在主线程上执行，它和浏览器的 EventLoop 有什么不同。")]),t._v(" "),n("h3",{attrs:{id:"同步任务和异步任务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#同步任务和异步任务"}},[t._v("#")]),t._v(" 同步任务和异步任务")]),t._v(" "),n("p",[t._v("首先，同步任务总是比异步任务更早执行。所以前面那段代码，下面这行最先执行：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"本轮循环和次轮循环"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#本轮循环和次轮循环"}},[t._v("#")]),t._v(" 本轮循环和次轮循环")]),t._v(" "),n("p",[t._v("异步任务可以分成"),n("strong",[t._v("两种")]),t._v("：")]),t._v(" "),n("ul",[n("li",[t._v("追加在本轮循环的异步任务")]),t._v(" "),n("li",[t._v("追加在次轮循环的异步任务")])]),t._v(" "),n("p",[t._v('所谓"循环"，指的是事件循环（event loop）。')]),t._v(" "),n("p",[n("strong",[t._v("Node 规定，process.nextTick 和 Promise 的回调函数，追加在本轮循环，即同步任务一旦执行完成，就开始执行它们。而 setTimeout、setInterval、setImmediate 的回调函数，追加在次轮循环。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 下面两行，次轮循环执行")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setImmediate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 下面两行，本轮循环执行")]),t._v("\nprocess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nPromise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"process-nexttick"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#process-nexttick"}},[t._v("#")]),t._v(" process.nextTick()")]),t._v(" "),n("p",[t._v("process.nextTick 这个名字有点误导，它是在本轮循环执行的，而且是所有异步任务里面最快执行的。")]),t._v(" "),n("p",[t._v("Node 执行完所有同步任务，接下来就会执行 process.nextTick 的任务队列。所以，下面这行代码是第二个输出结果。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("基本上，如果你希望异步任务尽可能快地执行，那就使用 process.nextTick。")]),t._v(" "),n("h3",{attrs:{id:"微任务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#微任务"}},[t._v("#")]),t._v(" 微任务")]),t._v(" "),n("p",[t._v('根据语言规格，Promise 对象的回调函数，会进入异步任务里面的"微任务"（microtask）队列。')]),t._v(" "),n("p",[t._v("微任务队列追加在 process.nextTick 队列的后面，也属于本轮循环。所以，下面的代码总是先输出3，再输出4。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nPromise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4")]),t._v("\n")])])]),n("p",[n("img",{attrs:{src:a(211),alt:"microtask"}})]),t._v(" "),n("p",[n("strong",[t._v("注意，只有前一个队列全部清空以后，才会执行下一个队列。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nPromise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nprocess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nPromise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4")]),t._v("\n")])])]),n("p",[t._v("上面代码中，全部 process.nextTick 的回调函数，执行都会早于 Promise 的。")]),t._v(" "),n("p",[t._v("至此，循环的执行顺序就是：")]),t._v(" "),n("ol",[n("li",[t._v("同步任务")]),t._v(" "),n("li",[t._v("process.nextTick()")]),t._v(" "),n("li",[t._v("微任务")])]),t._v(" "),n("h3",{attrs:{id:"事件循环的概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事件循环的概念"}},[t._v("#")]),t._v(" 事件循环的概念")]),t._v(" "),n("p",[t._v("为了理解次轮循环的执行顺序，这就必须理解什么是事件循环（event loop）了。")]),t._v(" "),n("p",[t._v("Node 的官方文档是这样介绍的：")]),t._v(" "),n("blockquote",[n("p",[t._v('"When Node.js starts, it initializes the event loop, processes the provided input script which may make async API calls, schedule timers, or call process.nextTick(), then begins processing the event loop."')])]),t._v(" "),n("p",[t._v("它表达了三层意思。")]),t._v(" "),n("p",[t._v("首先，有些人以为，除了主线程，还存在一个单独的事件循环线程。不是这样的，只有一个主线程，事件循环是在主线程上完成的。")]),t._v(" "),n("p",[t._v("其次，Node 开始执行脚本时，会先进行事件循环的初始化，但是这时事件循环还没有开始，会先完成下面的事情：")]),t._v(" "),n("ul",[n("li",[t._v("同步任务")]),t._v(" "),n("li",[t._v("发出异步请求")]),t._v(" "),n("li",[t._v("规划定时器生效的时间")]),t._v(" "),n("li",[t._v("执行process.nextTick()等等")])]),t._v(" "),n("h3",{attrs:{id:"事件循环的六个阶段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事件循环的六个阶段"}},[t._v("#")]),t._v(" 事件循环的六个阶段")]),t._v(" "),n("p",[t._v("事件循环会无限次地执行，一轮又一轮。只有异步任务的回调函数队列清空了，才会停止执行。")]),t._v(" "),n("p",[t._v("每一轮的事件循环，"),n("strong",[t._v("分成六个阶段")]),t._v("。这些阶段会依次执行：")]),t._v(" "),n("ol",[n("li",[t._v("timers")]),t._v(" "),n("li",[t._v("I/O callbacks")]),t._v(" "),n("li",[t._v("idle, prepare")]),t._v(" "),n("li",[t._v("poll")]),t._v(" "),n("li",[t._v("check")]),t._v(" "),n("li",[t._v("close callbacks")])]),t._v(" "),n("p",[n("strong",[t._v("每个阶段都有一个先进先出的回调函数队列。只有一个阶段的回调函数队列清空了，该执行的回调函数都执行了，事件循环才会进入下一个阶段。")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(212),alt:"EventLoop"}})]),t._v(" "),n("p",[t._v("下面简单介绍一下每个阶段的含义：")]),t._v(" "),n("p",[n("strong",[t._v("1. timers")])]),t._v(" "),n("p",[t._v("这个是定时器阶段，处理 "),n("code",[t._v("setTimeout()")]),t._v(" 和 "),n("code",[t._v("setInterval()")]),t._v(" 的回调函数。进入这个阶段后，主线程会检查一下当前时间，是否满足定时器的条件。如果满足就执行回调函数，否则就离开这个阶段。")]),t._v(" "),n("p",[n("strong",[t._v("2. I/O callbacks")])]),t._v(" "),n("p",[t._v("除了以下操作的回调函数，其他的回调函数都在这个阶段执行。")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("setTimeout()")]),t._v(" 和 "),n("code",[t._v("setInterval()")]),t._v(" 的回调函数；")]),t._v(" "),n("li",[n("code",[t._v("setImmediate()")]),t._v(" 的回调函数；")]),t._v(" "),n("li",[t._v("用于关闭请求的回调函数，比如 "),n("code",[t._v("socket.on('close', ...)")]),t._v("。")])]),t._v(" "),n("p",[n("strong",[t._v("3. idle, prepare")])]),t._v(" "),n("p",[t._v("该阶段只供 libuv 内部调用，这里可以忽略。")]),t._v(" "),n("p",[n("strong",[t._v("4. Poll")])]),t._v(" "),n("p",[t._v("这个阶段是轮询时间，用于等待还未返回的 I/O 事件，比如服务器的回应、用户移动鼠标等等。")]),t._v(" "),n("p",[t._v("这个阶段的时间会比较长。如果没有其他异步任务要处理（比如到期的定时器），会一直停留在这个阶段，等待 I/O 请求返回结果。")]),t._v(" "),n("p",[n("strong",[t._v("5. check")])]),t._v(" "),n("p",[t._v("该阶段执行 "),n("code",[t._v("setImmediate()")]),t._v(" 的回调函数。")]),t._v(" "),n("p",[n("strong",[t._v("6. close callbacks")])]),t._v(" "),n("p",[t._v("该阶段执行关闭请求的回调函数，比如 "),n("code",[t._v("socket.on('close', ...)")]),t._v("。")]),t._v(" "),n("h3",{attrs:{id:"settimeout-和-setimmediate"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#settimeout-和-setimmediate"}},[t._v("#")]),t._v(" setTimeout 和 setImmediate")]),t._v(" "),n("p",[t._v("由于 "),n("code",[t._v("setTimeout")]),t._v(" 在 timers 阶段执行，而 "),n("code",[t._v("setImmediate")]),t._v(" 在 check 阶段执行。所以，"),n("code",[t._v("setTimeout")]),t._v(" 会早于 "),n("code",[t._v("setImmediate")]),t._v(" 完成。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setImmediate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("上面代码应该先输出 1，再输出 2，但是实际执行的时候，结果却是不确定，有时还会先输出 2，再输出 1。")]),t._v(" "),n("p",[t._v("这是因为 "),n("code",[t._v("setTimeout")]),t._v(" 的第二个参数默认为 0。但是实际上，Node 做不到0毫秒，最少也需要 1 毫秒，根据官方文档，第二个参数的取值范围在 1 毫秒到 2147483647 毫秒之间。也就是说，"),n("code",[t._v("setTimeout(f, 0)")]),t._v(" 等同于 "),n("code",[t._v("setTimeout(f, 1)")]),t._v("。")]),t._v(" "),n("p",[t._v("**实际执行的时候，进入事件循环以后，有可能到了 1 毫秒，也可能还没到 1 毫秒，取决于系统当时的状况。**如果没到 1 毫秒，那么 timers 阶段就会跳过，进入 check 阶段，先执行 "),n("code",[t._v("setImmediate")]),t._v(" 的回调函数。")]),t._v(" "),n("p",[t._v("但是，下面的代码一定是先输出 2，再输出 1：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nfs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setImmediate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("上面代码会先进入 I/O callbacks 阶段，然后是 check 阶段，最后才是 timers "),n("code",[t._v("阶段。因此，setImmediate")]),t._v(" 才会早于 "),n("code",[t._v("setTimeout")]),t._v(" 执行。")]),t._v(" "),n("h2",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2014/10/event-loop.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript 运行机制详解：再谈Event Loop"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/33058983",target:"_blank",rel:"noopener noreferrer"}},[t._v("详解JavaScript中的Event Loop（事件循环）机制"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.im/post/5aab2d896fb9a028b86dc2fd",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript 运行机制--Event Loop详解"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2018/02/node-event-loop.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node 定时器详解"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);