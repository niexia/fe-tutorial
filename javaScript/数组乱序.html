<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数组乱序 | fe-tutorial</title>
    <meta name="description" content="前端学习笔记">
    <link rel="icon" href="/fe-tutorial/favicon.ico">
    
    <link rel="preload" href="/fe-tutorial/assets/css/0.styles.d95e4697.css" as="style"><link rel="preload" href="/fe-tutorial/assets/js/app.83ad5f20.js" as="script"><link rel="preload" href="/fe-tutorial/assets/js/2.9b3345fe.js" as="script"><link rel="preload" href="/fe-tutorial/assets/js/42.4c4cb10a.js" as="script"><link rel="prefetch" href="/fe-tutorial/assets/js/10.edefbefc.js"><link rel="prefetch" href="/fe-tutorial/assets/js/11.31eb95a3.js"><link rel="prefetch" href="/fe-tutorial/assets/js/12.fd432713.js"><link rel="prefetch" href="/fe-tutorial/assets/js/13.15c2d96f.js"><link rel="prefetch" href="/fe-tutorial/assets/js/14.fd4a4c92.js"><link rel="prefetch" href="/fe-tutorial/assets/js/15.3b303404.js"><link rel="prefetch" href="/fe-tutorial/assets/js/16.42489512.js"><link rel="prefetch" href="/fe-tutorial/assets/js/17.22cfbd72.js"><link rel="prefetch" href="/fe-tutorial/assets/js/18.b5200278.js"><link rel="prefetch" href="/fe-tutorial/assets/js/19.9951f6a2.js"><link rel="prefetch" href="/fe-tutorial/assets/js/20.cd3db4db.js"><link rel="prefetch" href="/fe-tutorial/assets/js/21.5b822627.js"><link rel="prefetch" href="/fe-tutorial/assets/js/22.f96b97dd.js"><link rel="prefetch" href="/fe-tutorial/assets/js/23.bd0c9df4.js"><link rel="prefetch" href="/fe-tutorial/assets/js/24.dced6486.js"><link rel="prefetch" href="/fe-tutorial/assets/js/25.4ba00114.js"><link rel="prefetch" href="/fe-tutorial/assets/js/26.d4ebda1a.js"><link rel="prefetch" href="/fe-tutorial/assets/js/27.69933a2e.js"><link rel="prefetch" href="/fe-tutorial/assets/js/28.af0eb35a.js"><link rel="prefetch" href="/fe-tutorial/assets/js/29.ab5e9c20.js"><link rel="prefetch" href="/fe-tutorial/assets/js/3.f5841e8a.js"><link rel="prefetch" href="/fe-tutorial/assets/js/30.171f4d28.js"><link rel="prefetch" href="/fe-tutorial/assets/js/31.01417dc4.js"><link rel="prefetch" href="/fe-tutorial/assets/js/32.662b454e.js"><link rel="prefetch" href="/fe-tutorial/assets/js/33.41bbee99.js"><link rel="prefetch" href="/fe-tutorial/assets/js/34.25afc027.js"><link rel="prefetch" href="/fe-tutorial/assets/js/35.b6280e63.js"><link rel="prefetch" href="/fe-tutorial/assets/js/36.8c24ffed.js"><link rel="prefetch" href="/fe-tutorial/assets/js/37.d2c1b0d0.js"><link rel="prefetch" href="/fe-tutorial/assets/js/38.dbb78336.js"><link rel="prefetch" href="/fe-tutorial/assets/js/39.bdc0f4cd.js"><link rel="prefetch" href="/fe-tutorial/assets/js/4.a62211ff.js"><link rel="prefetch" href="/fe-tutorial/assets/js/40.cab7ec85.js"><link rel="prefetch" href="/fe-tutorial/assets/js/41.ec129698.js"><link rel="prefetch" href="/fe-tutorial/assets/js/43.3cbfbd21.js"><link rel="prefetch" href="/fe-tutorial/assets/js/44.4aa8411b.js"><link rel="prefetch" href="/fe-tutorial/assets/js/45.37beebd2.js"><link rel="prefetch" href="/fe-tutorial/assets/js/46.640027b0.js"><link rel="prefetch" href="/fe-tutorial/assets/js/47.75b6dbd2.js"><link rel="prefetch" href="/fe-tutorial/assets/js/48.03311ce2.js"><link rel="prefetch" href="/fe-tutorial/assets/js/49.420e3429.js"><link rel="prefetch" href="/fe-tutorial/assets/js/5.248e852f.js"><link rel="prefetch" href="/fe-tutorial/assets/js/50.ef86af47.js"><link rel="prefetch" href="/fe-tutorial/assets/js/51.509017b3.js"><link rel="prefetch" href="/fe-tutorial/assets/js/52.99453c8f.js"><link rel="prefetch" href="/fe-tutorial/assets/js/53.88af42be.js"><link rel="prefetch" href="/fe-tutorial/assets/js/54.0a409de1.js"><link rel="prefetch" href="/fe-tutorial/assets/js/55.33c2223b.js"><link rel="prefetch" href="/fe-tutorial/assets/js/56.0dd27231.js"><link rel="prefetch" href="/fe-tutorial/assets/js/57.0197d5e1.js"><link rel="prefetch" href="/fe-tutorial/assets/js/58.c964d80c.js"><link rel="prefetch" href="/fe-tutorial/assets/js/59.4478e96b.js"><link rel="prefetch" href="/fe-tutorial/assets/js/6.f0713c61.js"><link rel="prefetch" href="/fe-tutorial/assets/js/60.1b040383.js"><link rel="prefetch" href="/fe-tutorial/assets/js/61.3ad47b95.js"><link rel="prefetch" href="/fe-tutorial/assets/js/62.7f6f5cb2.js"><link rel="prefetch" href="/fe-tutorial/assets/js/63.6ddebfde.js"><link rel="prefetch" href="/fe-tutorial/assets/js/64.3dd969b8.js"><link rel="prefetch" href="/fe-tutorial/assets/js/65.696a93f5.js"><link rel="prefetch" href="/fe-tutorial/assets/js/66.6c1dbc73.js"><link rel="prefetch" href="/fe-tutorial/assets/js/67.df7fa7e3.js"><link rel="prefetch" href="/fe-tutorial/assets/js/68.97ff5a3c.js"><link rel="prefetch" href="/fe-tutorial/assets/js/69.1b3d8e9a.js"><link rel="prefetch" href="/fe-tutorial/assets/js/7.45e0711e.js"><link rel="prefetch" href="/fe-tutorial/assets/js/70.556f2b61.js"><link rel="prefetch" href="/fe-tutorial/assets/js/71.b5b7490d.js"><link rel="prefetch" href="/fe-tutorial/assets/js/72.3ec804ad.js"><link rel="prefetch" href="/fe-tutorial/assets/js/73.be9415bf.js"><link rel="prefetch" href="/fe-tutorial/assets/js/74.171bd42c.js"><link rel="prefetch" href="/fe-tutorial/assets/js/75.c37d9196.js"><link rel="prefetch" href="/fe-tutorial/assets/js/76.43a2bde7.js"><link rel="prefetch" href="/fe-tutorial/assets/js/77.113bd0d7.js"><link rel="prefetch" href="/fe-tutorial/assets/js/78.400bdaae.js"><link rel="prefetch" href="/fe-tutorial/assets/js/79.07908490.js"><link rel="prefetch" href="/fe-tutorial/assets/js/8.7e8fd415.js"><link rel="prefetch" href="/fe-tutorial/assets/js/80.667891a8.js"><link rel="prefetch" href="/fe-tutorial/assets/js/81.975d0365.js"><link rel="prefetch" href="/fe-tutorial/assets/js/82.f96457f5.js"><link rel="prefetch" href="/fe-tutorial/assets/js/83.db782284.js"><link rel="prefetch" href="/fe-tutorial/assets/js/84.32fc99b7.js"><link rel="prefetch" href="/fe-tutorial/assets/js/85.1e0d52e2.js"><link rel="prefetch" href="/fe-tutorial/assets/js/9.3590845f.js">
    <link rel="stylesheet" href="/fe-tutorial/assets/css/0.styles.d95e4697.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fe-tutorial/" class="home-link router-link-active"><!----> <span class="site-name">fe-tutorial</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fe-tutorial/algo/" class="nav-link">数据结构和算法</a></div><div class="nav-item"><a href="/fe-tutorial/javaScript/" class="nav-link router-link-active">JavaScript</a></div><div class="nav-item"><a href="/fe-tutorial/webpack/" class="nav-link">Webpack</a></div><div class="nav-item"><a href="https://niexias.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/niexias" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fe-tutorial/algo/" class="nav-link">数据结构和算法</a></div><div class="nav-item"><a href="/fe-tutorial/javaScript/" class="nav-link router-link-active">JavaScript</a></div><div class="nav-item"><a href="/fe-tutorial/webpack/" class="nav-link">Webpack</a></div><div class="nav-item"><a href="https://niexias.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/niexias" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fe-tutorial/javaScript/" class="sidebar-link">介绍</a></li><li><a href="/fe-tutorial/javaScript/执行环境和执行栈.html" class="sidebar-link">执行环境和执行栈</a></li><li><a href="/fe-tutorial/javaScript/作用域和闭包.html" class="sidebar-link">作用域和闭包</a></li><li><a href="/fe-tutorial/javaScript/this.html" class="sidebar-link">this</a></li><li><a href="/fe-tutorial/javaScript/对象、原型和原型链.html" class="sidebar-link">对象、原型和原型链</a></li><li><a href="/fe-tutorial/javaScript/实现继承.html" class="sidebar-link">实现继承</a></li><li><a href="/fe-tutorial/javaScript/实现new.html" class="sidebar-link">实现 new</a></li><li><a href="/fe-tutorial/javaScript/实现call,apply和bind.html" class="sidebar-link">call、apply 和 bind</a></li><li><a href="/fe-tutorial/javaScript/实现instanceof.html" class="sidebar-link">实现 instanceof</a></li><li><a href="/fe-tutorial/javaScript/深拷贝和浅拷贝.html" class="sidebar-link">深拷贝和浅拷贝</a></li><li><a href="/fe-tutorial/javaScript/节流函数和防抖函数.html" class="sidebar-link">节流函数和防抖函数</a></li><li><a href="/fe-tutorial/javaScript/高阶函数.html" class="sidebar-link">高阶函数</a></li><li><a href="/fe-tutorial/javaScript/函数柯里化.html" class="sidebar-link">函数柯里化</a></li><li><a href="/fe-tutorial/javaScript/EventEmitter.html" class="sidebar-link">EventEmitter</a></li><li><a href="/fe-tutorial/javaScript/实现Promise.html" class="sidebar-link">/javaScript/实现Promise.html</a></li><li><a href="/fe-tutorial/javaScript/实现异步打印.html" class="sidebar-link">实现异步打印</a></li><li><a href="/fe-tutorial/javaScript/数组去重,扁平化和最值.html" class="sidebar-link">数组去重，扁平化和最值</a></li><li><a href="/fe-tutorial/javaScript/数组乱序.html" class="active sidebar-link">数组乱序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fe-tutorial/javaScript/数组乱序.html#math-random" class="sidebar-link">Math.random</a></li><li class="sidebar-sub-header"><a href="/fe-tutorial/javaScript/数组乱序.html#fisher–yates" class="sidebar-link">Fisher–Yates</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fe-tutorial/javaScript/数组乱序.html#原始算法步骤" class="sidebar-link">原始算法步骤</a></li><li class="sidebar-sub-header"><a href="/fe-tutorial/javaScript/数组乱序.html#经典的算法" class="sidebar-link">经典的算法</a></li><li class="sidebar-sub-header"><a href="/fe-tutorial/javaScript/数组乱序.html#流行的算法" class="sidebar-link">流行的算法</a></li><li class="sidebar-sub-header"><a href="/fe-tutorial/javaScript/数组乱序.html#lodash-中的实现" class="sidebar-link">lodash 中的实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/fe-tutorial/javaScript/数组乱序.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/fe-tutorial/javaScript/懒加载.html" class="sidebar-link">懒加载</a></li><li><a href="/fe-tutorial/javaScript/无限滚动.html" class="sidebar-link">无限滚动</a></li><li><a href="/fe-tutorial/javaScript/虚拟滚动.html" class="sidebar-link">/javaScript/虚拟滚动.html</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>RegExp</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fe-tutorial/javaScript/RegExp/正则表达式.html" class="sidebar-link">正则表达式</a></li><li><a href="/fe-tutorial/javaScript/RegExp/RegExp的属性和方法.html" class="sidebar-link">RegExp 的属性和方法</a></li><li><a href="/fe-tutorial/javaScript/RegExp/应用.html" class="sidebar-link">应用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器工作原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fe-tutorial/javaScript/browser/浏览器的多进程和JS单线程.html" class="sidebar-link">浏览器的多进程和JS单线程</a></li><li><a href="/fe-tutorial/javaScript/browser/浏览器渲染过程.html" class="sidebar-link">浏览器的渲染过程</a></li><li><a href="/fe-tutorial/javaScript/browser/EventLoop.html" class="sidebar-link">Event Loop</a></li><li><a href="/fe-tutorial/javaScript/browser/栈空间和堆空间.html" class="sidebar-link">栈空间和堆空间</a></li><li><a href="/fe-tutorial/javaScript/browser/垃圾回收.html" class="sidebar-link">垃圾回收</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>性能优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fe-tutorial/javaScript/effective/性能优化.html" class="sidebar-link">性能优化</a></li><li><a href="/fe-tutorial/javaScript/effective/DNS缓存和预解析.html" class="sidebar-link">DNS 缓存和预解析</a></li><li><a href="/fe-tutorial/javaScript/effective/减少请求次数和体积.html" class="sidebar-link">减少请求次数和体积</a></li><li><a href="/fe-tutorial/javaScript/effective/利用缓存.html" class="sidebar-link">利用缓存</a></li><li><a href="/fe-tutorial/javaScript/effective/CDN.html" class="sidebar-link">CDN</a></li><li><a href="/fe-tutorial/javaScript/effective/浏览器渲染机制和优化.html" class="sidebar-link">浏览器渲染机制和优化</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="数组乱序"><a href="#数组乱序" class="header-anchor">#</a> 数组乱序</h1> <p>乱序的意思就是将数组打乱。</p> <h2 id="math-random"><a href="#math-random" class="header-anchor">#</a> Math.random</h2> <p>一个经常会遇见的写法是使用 <code>Math.random()</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>Math.random() - 0.5</code> 会随机得到一个正数、负数或者 0。如果是正数则降序排列，如果是负数则升序排列，如果是 0 就不变，然后不断的升序或者降序，最终得到一个乱序的数组。</p> <p>看起来很完美的方案，但是实际上不尽人意，写个 demo 测试：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> times <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
  arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  times<span class="token punctuation">[</span>arr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>times<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {1: 24904, 2: 7057, 3: 21116, 4: 18826, 5: 28097}</span>
</code></pre></div><p>测试原理是：将 <code>[1, 2, 3, 4, 5]</code> 乱序 10 万次，然后统计最后一位元素是 1、2、3、4、5 的次数分别是多少。</p> <p>一次随机得到的结果是：</p> <div class="language- extra-class"><pre class="language-text"><code>[30636, 30906, 20456, 11743, 6259]
</code></pre></div><p>可以看到，这几数字出现的次数之间的差别是很大的，最后一个元素是 2 的次数远远小于 1 的次数。所以这个方案有问题。</p> <p>可是明明感觉这个方法还不错呐？而实际上上，这是受到 <code>sort()</code> 底层实现的排序算法影响的。v8 在处理 <code>sort</code> 方法时，当目标数组长度小于 10 时，使用插入排序；反之，使用快速排序和插入排序的混合排序（现在已经使用 <a href="https://segmentfault.com/a/1190000020280815#articleHeader3" target="_blank" rel="noopener noreferrer">Timsort<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）。通过这种排序方法的乱序并不彻底。</p> <p>那么如何实现真正的乱序呢？而这就要提到经典的 Fisher–Yates 算法。</p> <h2 id="fisher–yates"><a href="#fisher–yates" class="header-anchor">#</a> Fisher–Yates</h2> <p>Fisher–Yates shuffle 洗牌算法是一种生成有限序列的随机排列的算法，之所以有这个命名,当然是由Fisher和Yates这两个人的发明的。</p> <h3 id="原始算法步骤"><a href="#原始算法步骤" class="header-anchor">#</a> 原始算法步骤</h3> <p>开始只是用来人工混排一组数字序列，原始算法的步骤非常容易理解：</p> <ol><li>写下从 1 到 N 的数字</li> <li>取一个从 1 到剩下的数字（包括这个数字）的随机数 k</li> <li>从低位开始，得到第 k 个数字（这个数字还没有被取出），把它写在独立的一个列表的最后一位</li> <li>重复第 2 步，直到所有的数字都被取出</li> <li>第 3 步写出的这个序列，现在就是原始数字的随机排列</li></ol> <h3 id="经典的算法"><a href="#经典的算法" class="header-anchor">#</a> 经典的算法</h3> <p>第三步真的去从低位开始数数，实际上可以通过数组的随机访问性直接读取：</p> <ol><li>给定一组待混排的有限序列 P</li> <li>新初始化一个空的序列 Q</li> <li>从 P 中随机选取一个元素</li> <li>将该元素放到序列 Q 的最后面,并从序列 P 中移除该元素</li> <li>重复 3-4 的步骤,直到序列 P 中元素全部选取到了序列 Q 中,得到的序列 Q 即为一组 P 的混排序列</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 随机生成元素的索引地址</span>
    <span class="token keyword">const</span> idx <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> i<span class="token punctuation">)</span> <span class="token comment">// 0 ~ arr.length - 1</span>
    res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
    arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res
<span class="token punctuation">}</span>
</code></pre></div><h3 id="流行的算法"><a href="#流行的算法" class="header-anchor">#</a> 流行的算法</h3> <p>经典算法中需要借助 <code>res</code> 所以空间复杂度为 <code>O(n)</code>。现代算法在操作过程中不需要借助一个新的序列，而可以直接在当前序列中完成.算法步骤大致相同:</p> <ol><li>给定一组待混排的有限序列 P</li> <li>从 P 中随机选取一个未混排的元素</li> <li>将该元素与序列 P 的最后一个未混排的元素交换</li> <li>重复 2-3 的步骤,直到序列 P 中元素全部混排过</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 从 arr 中选取一个未混排的元素的索引</span>
    <span class="token keyword">let</span> idx <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 ~ arr.length - 1</span>
    <span class="token comment">// 将它和最后一个未混排的元素，即当前元素交换</span>
    <span class="token keyword">let</span> temp <span class="token operator">=</span> arr<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    arr<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    arr<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>原理很简单，就是遍历数组元素，然后将当前元素与以后随机位置的元素进行交换，从代码中也可以看出，这样乱序的就会更加彻底。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> times <span class="token operator">=</span> <span class="token number">100000</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> times<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">?</span> res<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">++</span> <span class="token punctuation">:</span>  res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 为了方便展示，转换成百分比</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">/</span> times <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token string">'%'</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="shuffle"></p> <p>真正的实现了乱序的效果！</p> <h3 id="lodash-中的实现"><a href="#lodash-中的实现" class="header-anchor">#</a> lodash 中的实现</h3> <p>在 lodash 中 <code>shuffle</code> 的实现如下，Lodash 库中 <code>Shuffle</code> 就是现代算法的实现，不同的是其交换的元素是从数组首位开始的，并且返回一个新数组：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> length <span class="token operator">=</span> array <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> lastIndex <span class="token operator">=</span> length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token comment">// const result = copyArray(array);</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">++</span>index <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过 index +，保证向后推移，避免重复</span>
    <span class="token keyword">const</span> rand <span class="token operator">=</span> index <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>lastIndex <span class="token operator">-</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> result<span class="token punctuation">[</span>rand<span class="token punctuation">]</span><span class="token punctuation">;</span>
    result<span class="token punctuation">[</span>rand<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    result<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://github.com/mqyqingfeng/Blog/issues/51" target="_blank" rel="noopener noreferrer">JavaScript专题之乱序<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/star91/p/FisherYates-shuffle-xi-pai-suan-fa.html" target="_blank" rel="noopener noreferrer">Fisher–Yates shuffle 洗牌算法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">11/16/2019, 12:32:45 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fe-tutorial/javaScript/数组去重,扁平化和最值.html" class="prev">数组去重，扁平化和最值</a></span> <span class="next"><a href="/fe-tutorial/javaScript/懒加载.html">懒加载</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/fe-tutorial/assets/js/app.83ad5f20.js" defer></script><script src="/fe-tutorial/assets/js/2.9b3345fe.js" defer></script><script src="/fe-tutorial/assets/js/42.4c4cb10a.js" defer></script>
  </body>
</html>
